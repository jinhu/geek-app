<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<script src="../bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-styles/demo-pages.html">
<link rel="import" href="../bower_components/iron-flex-layout/classes/iron-flex-layout.html">

<dom-module id="geek-panel">
  <template>
    <div class="flex-1" style="margin: 3px; padding: 3px">
      <div class="horizontal-section-container">
        <span>{{title}}</span>
          <iron-ajax auto
                     id="ajax"
                     url="{{src}}?status={{status}}"
                     handle-as="json"
                     last-response="{{items}}"></iron-ajax>

          <template is="dom-repeat" items="[[items]]">
            <template is="dom-if" if="{{item.item.title}}">
              <paper-material elevation="2" class="horizontal-section">
                <h2>[[item.item.rank]]<a href="[[item.item.link]]" target="_blank">[[item.item.title]]</a></h2>
                <iron-image src="[[item.item.image_url]]" width="280" height="200" sizing="cover" preload fade></iron-image>
                <p>[[item.item.description]]</p>
                <p>by: [[item.item.author]]</p>
                <p>Geek points: [[item.item.points ]]</p>
                <a href="http://localhost:3000/geek_items/[[item.id]]?status=in_progress" id="next" icon="menu" >start</a>

              </paper-material>
            </template>
          </template>
      </div>
    </div>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'geek-panel',
//        ready: function() {
//          this.$.ajax.url = this.src;
//          this.$.ajax.params = {"status":this.status};
//          this.$.ajax.generateRequest();
//        },

        properties: {
          src: {
            type: String,
            value: 'http://localhost:3000/geek_items',
            notify: true
          },
          title: {
            type: String,
            value: 'todo',
            notify: true
          },
          status: {
            type: String,
            value: 'to_do',
            notify: true
          },
          filter: {
            type: String,
            value: 'to_do',
            notify: true
          }
        }
      });

    })();
  </script>

</dom-module>
